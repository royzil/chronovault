<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChronoVault - Watch Collection Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // Lucide icons as SVG
        const icons = {
            watch: '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="7"/><polyline points="12 9 12 12 13.5 13.5"/><path d="m16.51 17.35-.35 3.83a2 2 0 0 1-2 1.82H9.83a2 2 0 0 1-2-1.82l-.35-3.83m.01-10.7.35-3.83A2 2 0 0 1 9.83 1h4.35a2 2 0 0 1 2 1.82l.35 3.83"/></svg>',
            watchLarge: '<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="7"/><polyline points="12 9 12 12 13.5 13.5"/><path d="m16.51 17.35-.35 3.83a2 2 0 0 1-2 1.82H9.83a2 2 0 0 1-2-1.82l-.35-3.83m.01-10.7.35-3.83A2 2 0 0 1 9.83 1h4.35a2 2 0 0 1 2 1.82l.35 3.83"/></svg>',
            plus: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>',
            edit: '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/><path d="m15 5 4 4"/></svg>',
            trash: '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>',
            x: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',
            camera: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>'
        };

        class ChronoVault {
            constructor() {
                this.watches = [];
                this.openDialog = false;
                this.editingWatch = null;
                this.formData = this.getEmptyForm();
                
                this.init();
            }

            getEmptyForm() {
                return {
                    brand: '',
                    model: '',
                    reference: '',
                    purchaseDate: '',
                    price: '',
                    notes: '',
                    image: ''
                };
            }

            init() {
                this.loadWatches();
                this.render();
            }

            loadWatches() {
                try {
                    const stored = localStorage.getItem('chronovault_watches');
                    if (stored) {
                        this.watches = JSON.parse(stored);
                    }
                } catch (error) {
                    console.error('Error loading watches:', error);
                }
            }

            saveWatches() {
                localStorage.setItem('chronovault_watches', JSON.stringify(this.watches));
            }

            handleImageUpload(e) {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onloadend = () => {
                    this.formData.image = reader.result;
                    this.render();
                };
                reader.readAsDataURL(file);
            }

            handleSubmit() {
                if (!this.formData.brand || !this.formData.model) {
                    alert('Brand and Model are required');
                    return;
                }

                if (this.editingWatch !== null) {
                    this.watches[this.editingWatch] = { ...this.formData, id: Date.now() };
                } else {
                    this.watches.unshift({ ...this.formData, id: Date.now() });
                }

                this.saveWatches();
                this.handleCloseDialog();
            }

            handleEdit(index) {
                this.formData = { ...this.watches[index] };
                this.editingWatch = index;
                this.openDialog = true;
                this.render();
            }

            handleDelete(index) {
                if (confirm('Are you sure you want to delete this watch?')) {
                    this.watches.splice(index, 1);
                    this.saveWatches();
                    this.render();
                }
            }

            handleCloseDialog() {
                this.openDialog = false;
                this.editingWatch = null;
                this.formData = this.getEmptyForm();
                this.render();
            }

            render() {
                const app = document.getElementById('app');
                app.innerHTML = `
                    <div class="min-h-screen bg-black pb-20">
                        <!-- Header -->
                        <div class="bg-neutral-950 border-b border-neutral-800 sticky top-0 z-10">
                            <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="text-green-400">${icons.watch}</div>
                                    <h1 class="text-2xl font-bold text-green-400 tracking-tight">ChronoVault</h1>
                                </div>
                                <div class="text-neutral-400 text-sm font-medium">
                                    ${this.watches.length} ${this.watches.length === 1 ? 'Watch' : 'Watches'}
                                </div>
                            </div>
                        </div>

                        <!-- Main Content -->
                        <div class="max-w-7xl mx-auto px-4 py-6">
                            ${this.watches.length === 0 ? `
                                <div class="text-center mt-20">
                                    <div class="mx-auto mb-4 text-neutral-700">${icons.watchLarge}</div>
                                    <h2 class="text-xl font-semibold text-neutral-500 mb-2">
                                        No watches in your collection yet
                                    </h2>
                                    <p class="text-neutral-600 text-sm">
                                        Tap the + button to add your first timepiece
                                    </p>
                                </div>
                            ` : `
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    ${this.watches.map((watch, index) => `
                                        <div class="bg-neutral-900 rounded-lg overflow-hidden border border-neutral-800 flex flex-col">
                                            ${watch.image ? `
                                                <img 
                                                    src="${watch.image}" 
                                                    alt="${watch.brand} ${watch.model}"
                                                    class="w-full h-48 object-cover"
                                                />
                                            ` : ''}
                                            <div class="p-4 flex-grow">
                                                <h3 class="text-lg font-semibold text-green-400 mb-1">
                                                    ${watch.brand}
                                                </h3>
                                                <p class="text-white font-medium mb-3">
                                                    ${watch.model}
                                                </p>
                                                ${watch.reference ? `
                                                    <p class="text-sm text-neutral-400 mb-1">
                                                        Ref: ${watch.reference}
                                                    </p>
                                                ` : ''}
                                                ${watch.purchaseDate ? `
                                                    <p class="text-sm text-neutral-400 mb-1">
                                                        Purchased: ${watch.purchaseDate}
                                                    </p>
                                                ` : ''}
                                                ${watch.price ? `
                                                    <p class="text-sm text-neutral-400 mb-2">
                                                        Price: $${watch.price}
                                                    </p>
                                                ` : ''}
                                                ${watch.notes ? `
                                                    <p class="text-sm text-neutral-300 italic mt-2">
                                                        ${watch.notes}
                                                    </p>
                                                ` : ''}
                                            </div>
                                            <div class="p-3 border-t border-neutral-800 flex justify-end gap-2">
                                                <button
                                                    onclick="app.handleEdit(${index})"
                                                    class="p-2 text-green-400 hover:bg-neutral-800 rounded transition"
                                                >
                                                    ${icons.edit}
                                                </button>
                                                <button
                                                    onclick="app.handleDelete(${index})"
                                                    class="p-2 text-red-500 hover:bg-neutral-800 rounded transition"
                                                >
                                                    ${icons.trash}
                                                </button>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            `}
                        </div>

                        <!-- Floating Action Button -->
                        <button
                            onclick="app.openDialog = true; app.render();"
                            class="fixed bottom-6 right-6 bg-green-500 hover:bg-green-600 text-white rounded-full p-4 shadow-lg transition z-20"
                        >
                            ${icons.plus}
                        </button>

                        ${this.openDialog ? this.renderDialog() : ''}
                    </div>
                `;
            }

            renderDialog() {
                return `
                    <div class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
                        <div class="bg-neutral-900 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                            <div class="sticky top-0 bg-neutral-900 border-b border-neutral-800 p-4 flex items-center justify-between">
                                <h2 class="text-xl font-semibold text-green-400">
                                    ${this.editingWatch !== null ? 'Edit Watch' : 'Add New Watch'}
                                </h2>
                                <button
                                    onclick="app.handleCloseDialog()"
                                    class="text-neutral-400 hover:text-white transition"
                                >
                                    ${icons.x}
                                </button>
                            </div>
                            
                            <div class="p-4 space-y-4">
                                <!-- Image Upload -->
                                <div>
                                    <label class="block w-full">
                                        <div class="border-2 border-dashed border-neutral-700 rounded-lg p-6 text-center hover:border-green-500 transition cursor-pointer">
                                            ${this.formData.image ? `
                                                <img 
                                                    src="${this.formData.image}" 
                                                    alt="Preview" 
                                                    class="max-h-48 mx-auto rounded"
                                                />
                                            ` : `
                                                <div>
                                                    <div class="mx-auto mb-2 text-neutral-600">${icons.camera}</div>
                                                    <p class="text-sm text-neutral-400">Tap to upload photo</p>
                                                </div>
                                            `}
                                        </div>
                                        <input
                                            type="file"
                                            accept="image/*"
                                            onchange="app.handleImageUpload(event)"
                                            class="hidden"
                                        />
                                    </label>
                                </div>

                                <!-- Brand -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Brand *
                                    </label>
                                    <input
                                        type="text"
                                        value="${this.formData.brand}"
                                        oninput="app.formData.brand = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Model -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Model *
                                    </label>
                                    <input
                                        type="text"
                                        value="${this.formData.model}"
                                        oninput="app.formData.model = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Reference Number -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Reference Number
                                    </label>
                                    <input
                                        type="text"
                                        value="${this.formData.reference}"
                                        oninput="app.formData.reference = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Purchase Date -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Purchase Date
                                    </label>
                                    <input
                                        type="date"
                                        value="${this.formData.purchaseDate}"
                                        oninput="app.formData.purchaseDate = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Price -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Price ($)
                                    </label>
                                    <input
                                        type="number"
                                        value="${this.formData.price}"
                                        oninput="app.formData.price = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Notes -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Notes
                                    </label>
                                    <textarea
                                        oninput="app.formData.notes = this.value"
                                        rows="3"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500 resize-none"
                                    >${this.formData.notes}</textarea>
                                </div>

                                <!-- Action Buttons -->
                                <div class="flex gap-2 pt-2">
                                    <button
                                        type="button"
                                        onclick="app.handleCloseDialog()"
                                   <!-- Brand -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Brand *
                                    </label>
                                    <input
                                        type="text"
                                        value="${this.formData.brand}"
                                        oninput="app.formData.brand = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Model -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Model *
                                    </label>
                                    <input
                                        type="text"
                                        value="${this.formData.model}"
                                        oninput="app.formData.model = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Reference Number -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Reference Number
                                    </label>
                                    <input
                                        type="text"
                                        value="${this.formData.reference}"
                                        oninput="app.formData.reference = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Purchase Date -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Purchase Date
                                    </label>
                                    <input
                                        type="date"
                                        value="${this.formData.purchaseDate}"
                                        oninput="app.formData.purchaseDate = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Price -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Price ($)
                                    </label>
                                    <input
                                        type="number"
                                        value="${this.formData.price}"
                                        oninput="app.formData.price = this.value"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500"
                                    />
                                </div>

                                <!-- Notes -->
                                <div>
                                    <label class="block text-sm font-medium text-neutral-400 mb-1">
                                        Notes
                                    </label>
                                    <textarea
                                        oninput="app.formData.notes = this.value"
                                        rows="3"
                                        class="w-full bg-neutral-800 border border-neutral-700 rounded px-3 py-2 text-white focus:outline-none focus:border-green-500 resize-none"
                                    >${this.formData.notes}</textarea>
                                </div>

                                <!-- Action Buttons -->
                                <div class="flex gap-2 pt-2">
                                    <button
                                        type="button"
                                        onclick="app.handleCloseDialog()"
                                        class="flex-1 px-4 py-2 bg-neutral-800 text-neutral-300 rounded hover:bg-neutral-700 transition"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        type="button"
                                        onclick="app.handleSubmit()"
                                        class="flex-1 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition font-medium"
                                    >
                                        ${this.editingWatch !== null ? 'Update' : 'Add Watch'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // Initialize app
        window.app = new ChronoVault();
    </script>
</body>
</html>
